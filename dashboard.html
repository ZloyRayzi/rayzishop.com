<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>RayziShop — Личный кабинет</title>
<style>
  body {
    background: #121212;
    color: #eee;
    font-family: 'Montserrat', sans-serif;
    margin: 0; padding: 20px;
  }
  header {
    background: #1f1f1f;
    padding: 15px 30px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.5);
    display: flex; align-items: center; justify-content: space-between;
  }
  .logo {
    color: #4caf50;
    font-weight: 900;
    font-size: 28px;
    text-decoration: none;
  }
  nav a {
    color: #eee;
    margin-left: 25px;
    text-decoration: none;
    font-weight: 600;
  }
  nav a:hover {
    color: #4caf50;
  }
  main {
    max-width: 900px;
    margin: 30px auto;
  }
  h1 {
    color: #4caf50;
  }
  form {
    background: #222;
    padding: 20px;
    border-radius: 15px;
    margin-bottom: 30px;
    box-shadow: 0 0 15px #4caf50cc;
  }
  form input, form textarea {
    width: 100%;
    padding: 10px;
    margin-top: 10px;
    border-radius: 8px;
    border: none;
    background: #333;
    color: #eee;
    font-size: 1rem;
    resize: vertical;
  }
  form button {
    margin-top: 15px;
    padding: 12px 20px;
    background: #4caf50;
    border: none;
    border-radius: 10px;
    color: white;
    font-weight: 700;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  form button:hover {
    background: #3a9c3a;
  }
  .user-products {
    margin-top: 20px;
  }
  .product-item {
    background: #222;
    padding: 15px;
    border-radius: 12px;
    margin-bottom: 15px;
    box-shadow: 0 0 10px #4caf50aa;
    display: flex;
    align-items: center;
    gap: 15px;
  }
  .product-item img {
    width: 100px;
    height: 70px;
    object-fit: cover;
    border-radius: 8px;
  }
  .product-details {
    flex-grow: 1;
  }
  .product-details h3 {
    margin: 0 0 5px 0;
    color: #4caf50;
  }
  .product-details p {
    margin: 0 0 5px 0;
    color: #ccc;
  }
  .product-details .price {
    font-weight: 700;
    color: #a0d468;
  }
  .product-item button {
    background: #e74c3c;
    border: none;
    padding: 8px 14px;
    border-radius: 8px;
    color: white;
    cursor: pointer;
    font-weight: 700;
    transition: background 0.3s ease;
  }
  .product-item button:hover {
    background: #c0392b;
  }
</style>
<script>
  // Проверка авторизации
  function checkAuth() {
    if (!localStorage.getItem('loggedIn')) {
      alert('Пожалуйста, войдите в аккаунт.');
      window.location.href = 'register.html';
    }
  }

  // Загрузка и показ товаров пользователя
  function loadUserProducts() {
    const user = JSON.parse(localStorage.getItem('user'));
    if (!user) return;

    const allProducts = JSON.parse(localStorage.getItem('userProducts') || '{}');
    const userProducts = allProducts[user.username] || [];

    const container = document.querySelector('.user-products');
    container.innerHTML = '';

    if (userProducts.length === 0) {
      container.innerHTML = '<p>Вы еще не добавили товаров.</p>';
      return;
    }

    userProducts.forEach((p, index) => {
      const div = document.createElement('div');
      div.className = 'product-item';
      div.innerHTML = `
        <img src="${p.image}" alt="${p.name}">
        <div class="product-details">
          <h3>${p.name}</h3>
          <p>${p.description}</p>
          <div class="price">${p.price} ${p.currency || '₴'}</div>
        </div>
        <button onclick="deleteProduct(${index})">Удалить</button>
      `;
      container.appendChild(div);
    });
  }

  // Добавление товара
  function addProduct(e) {
    e.preventDefault();

    const user = JSON.parse(localStorage.getItem('user'));
    if (!user) return alert('Ошибка: пользователь не найден.');

    const name = document.getElementById('prod-name').value.trim();
    const description = document.getElementById('prod-desc').value.trim();
    const price = parseFloat(document.getElementById('prod-price').value);
    const currency = document.getElementById('prod-currency').value;
    const imageUrl = document.getElementById('prod-image').value.trim() || 'https://via.placeholder.com/100x70?text=No+Image';

    if (!name || !description || isNaN(price)) {
      alert('Пожалуйста, заполните все поля корректно.');
      return;
    }

    const allProducts = JSON.parse(localStorage.getItem('userProducts') || '{}');
    const userProducts = allProducts[user.username] || [];

    userProducts.push({ name, description, price: price.toFixed(2), currency, image: imageUrl });

    allProducts[user.username] = userProducts;
    localStorage.setItem('userProducts', JSON.stringify(allProducts));

    document.getElementById('add-product-form').reset();
    loadUserProducts();
    alert('Товар успешно добавлен!');
  }

  // Удаление товара
  function deleteProduct(index) {
    const user = JSON.parse(localStorage.getItem('user'));
    if (!user) return;

    const allProducts = JSON.parse(localStorage.getItem('userProducts') || '{}');
    const userProducts = allProducts[user.username] || [];

    userProducts.splice(index, 1);
    allProducts[user.username] = userProducts;
    localStorage.setItem('userProducts', JSON.stringify(allProducts));

    loadUserProducts();
  }

  window.onload = () => {
    checkAuth();
    loadUserProducts();

    document.getElementById('add-product-form').addEventListener('submit', addProduct);
  }
</script>
</head>
<body>
<header>
  <a href="index.html" class="logo">RayziShop</a>
  <nav>
    <a href="index.html">Главная</a>
    <a href="home.html">Товары</a>
    <a href="register.html">Регистрация</a>
    <a href="#" onclick="checkAuth();">Профиль</a>
  </nav>
</header>

<main>
  <h1>Личный кабинет — Ваши товары</h1>

  <form id="add-product-form">
    <h2>Добавить новый товар</h2>
    <input type="text" id="prod-name" placeholder="Название товара" required />
    <textarea id="prod-desc" placeholder="Описание товара" rows="3" required></textarea>
    <input type="number" id="prod-price" placeholder="Цена" min="0" step="0.01" required />
    <select id="prod-currency" required>
      <option value="₴">Гривны (₴)</option>
      <option value="$">Доллары ($)</option>
      <option value="€">Евро (€)</option>
    </select>
    <input type="url" id="prod-image" placeholder="URL картинки (необязательно)" />
    <button type="submit">Добавить товар</button>
  </form>

  <section class="user-products">
    <!-- Здесь будут товары пользователя -->
  </section>
</main>
</body>
</html>


